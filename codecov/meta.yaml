- name: codecov
  title: Codecov Bash Uploader compromised via CI/CD
  synopsis: Attackers modified Codecov's Bash Uploader script after gaining access to a private GCP key via a flawed Docker image creation process. The compromised script exfiltrated environment variables (credentials, tokens, keys) from customers' CI/CD environments. The modification was subtle, involving only changing an IP address.
  start_date: 2021-01-31
  end_date: 2021-04-01
  attribution_type: Unknown
  component_type: Application
  lang: Shell
  cause: Stolen credentials # Leaked CI/CD variable leading to image build compromise
  motive: Espionage # Credential harvesting
  insertion_phase: CI/CD # Compromise of the build/distribution process for the uploader script
  impact_type: Credential theft, Data theft
  references:
    - https://about.codecov.io/security-update/
    - https://www.reuters.com/technology/exclusive-us-investigating-breach-code-testing-company-codecov-sources-2021-04-29/
    - https://github.com/codecov/codecov-bash/commit/373961d648b96a1402514e4e457746d67f782a83 # Commit showing the revert
  artifacts:
    - url: https://web.archive.org/web/20210415192150/https://storage.googleapis.com/codecov/bash # Archived copy of uploader script directory
  impacted_hashes:
    - 6730a44f191168573710105178477116f718333b6de1f008ff811066c424bb59 # Hash of the compromised bash uploader script (needs verification if this specific hash is the compromised one)
